package LGCSTtest;

import org.openqa.selenium.*;
import org.openqa.selenium.chrome.*;
import org.testng.Assert;
import org.testng.annotations.*;

import java.awt.AWTException;
import java.awt.Robot;
import java.awt.Toolkit;
import java.awt.datatransfer.StringSelection;
import java.awt.event.KeyEvent;
import java.io.File;
import java.util.concurrent.TimeUnit;

public class organic{

    public String baseUrl = "https://www.lgcstandards.com/GB/en/orderRequest";
    
    String driverPath = "C:\\chromedriver.exe";
    
    public WebDriver driver ; 
    
    public String path = new File("CustomQuoteUpload_15_CAS_Only.xls").getAbsolutePath();
    
    
  	@BeforeTest
  	public void openpage(){
        System.out.println("launching Chrome browser"); 
        
        System.setProperty("webdriver.chrome.driver", driverPath);
        
        driver = new ChromeDriver();
        
        driver.manage().window().maximize();
  	}
  
  @Test
  public void verifypage() {
      
      driver.get(baseUrl);
      
      String expectedTitle = "LGC Standards";
      
      String actualTitle = driver.getTitle();
      
      Assert.assertEquals(actualTitle, expectedTitle);    
  }
  
  @Test
  public void selectorganic() {
	  
	  driver.get(baseUrl);
	  
	  String organicbutton = driver.findElement(By.xpath("//*[@id=\"organicRadioBtn\"]/span[2]/h3")).getText();
	  
      String expectedText = "Organic";
      
      Assert.assertEquals(organicbutton, expectedText);
	  
      driver.findElement(By.id("organicRadioBtn")).isSelected();
      
      driver.findElement(By.id("cqSelectCustomSolutionTypeBtn")).click();
  }
  
  @Test
  public void uploadfile() throws AWTException {
	  
	  driver.get(baseUrl);
	  
	  driver.findElement(By.xpath("//*[@id=\"cqUploadFile\"]/div/div/i")).click();
	  
	  driver.manage().timeouts().implicitlyWait(3, TimeUnit.SECONDS);
	  
	  driver.switchTo().activeElement().sendKeys(path);
	  
	  StringSelection str = new StringSelection(path);
	  Toolkit.getDefaultToolkit().getSystemClipboard().setContents(str, null);
	  
	  
	  Robot rb = new Robot();
	  
	     // press Contol+V for pasting
	  rb.keyPress(KeyEvent.VK_CONTROL);
	  rb.keyPress(KeyEvent.VK_V);
	 
	    // release Contol+V for pasting
	  rb.keyRelease(KeyEvent.VK_CONTROL);
	  rb.keyRelease(KeyEvent.VK_V);
	 
	    // for pressing and releasing Enter
	  //rb.keyPress(KeyEvent.VK_ENTER);
	  //rb.keyRelease(KeyEvent.VK_ENTER);	  
	  
	  
	  
	  //driver.findElement(By.xpath("//*[@id=\"cqUploadFile\"]/div/div/i")).sendKeys(path);
	  
	  //driver.findElement(By.xpath("//*[@id=\"cqUploadFile\"]/div/div/i")).sendKeys(Keys.ENTER);
	  
      //driver.findElement(By.id("organicRadioBtn")).isSelected();
      
      //driver.findElement(By.id("cqSelectCustomSolutionTypeBtn")).click();
  }
//	@AfterTest
//	public void tearDown(){
//      	driver.quit();
//	}

}
